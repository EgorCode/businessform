# Руководство по плавающей кнопке ИИ

## Обзор

В проект была добавлена глобальная плавающая кнопка ИИ-ассистента, которая доступна на всех страницах приложения. Кнопка имеет пульсирующую анимацию и эффект появления/исчезновения при прокрутке страницы. Чат можно легко открыть и закрыть, он не перекрывает большую часть сайта.

## Функциональность

### Основные возможности:
- **Глобальная доступность**: Кнопка отображается на всех страницах приложения
- **Пульсирующая анимация**: Привлекает внимание пользователя
- **Умное появление/исчезновение**: Кнопка скрывается при прокрутке вниз и появляется при прокрутке вверх
- **Адаптивный дизайн**: Корректно работает на мобильных устройствах
- **Сохранение состояния**: История чата сохраняется между переходами между страницами
- **Управляемый чат**: Чат можно открыть и закрыть, он не перекрывает весь сайт
- **Оптимальное позиционирование**: Чат адаптируется под размер экрана
- **Левое расположение**: Кнопка расположена в левом нижнем углу для лучшей заметности
- **Мгновенная доступность**: Кнопка видна сразу при загрузке страницы

### Визуальные эффекты:
- **Пульсация**: Зеленый индикатор онлайн-статуса с анимацией
- **Эффект свечения**: При наведении курсора
- **Плавные переходы**: Появление/исчезновение при прокрутке
- **Масштабирование**: Увеличение при наведении
- **Адаптивный размер**: Чат подстраивается под размер экрана
- **Оптимальное позиционирование**: Кнопка в левом нижнем углу с отступом 20px

## Архитектура

### Компоненты:
1. **AIAssistantContext** - Глобальный контекст для управления состоянием
2. **FloatingAIButton** - Компонент плавающей кнопки
3. **EnhancedAIAssistant** - Модифицированный чат-интерфейс
4. **useScrollVisibility** - Хук для отслеживания прокрутки

### Файлы:
- `src/contexts/AIAssistantContext.tsx` - Глобальный контекст
- `src/components/FloatingAIButton.tsx` - Плавающая кнопка
- `src/components/EnhancedAIAssistant.tsx` - Чат-интерфейс
- `src/hooks/useScrollVisibility.ts` - Хук прокрутки
- `src/index.css` - CSS-анимации

## Настройки

### Параметры прокрутки:
- **Порог появления**: 100px (кнопка скрывается после прокрутки на 100px вниз)
- **Throttle**: 100ms (оптимизация производительности)
- **Направление**: Кнопка появляется при прокрутке вверх, скрывается при прокрутке вниз

### CSS-классы:
- `.floating-ai-button` - Основной стиль кнопки
- `.scroll-visible` - Состояние видимости
- `.scroll-hidden` - Состояние скрытия
- `.animate-pulse` - Пульсирующая анимация

## Интеграция

### Использование в компонентах:
```tsx
import { useAIAssistant } from '@/contexts/AIAssistantContext';

const MyComponent = () => {
  const { toggleMinimized, isVisible } = useAIAssistant();
  
  const handleOpenChat = () => {
    toggleMinimized(); // Открыть чат
  };
  
  return (
    <button onClick={handleOpenChat}>
      Открыть ИИ-ассистента
    </button>
  );
};
```

### Доступные методы контекста:
- `toggleMinimized()` - Переключить состояние чата
- `setVisibility(visible)` - Установить видимость кнопки
- `addMessage(message)` - Добавить сообщение в чат
- `clearMessages()` - Очистить историю чата
- `setMessages(messages)` - Установить сообщения

## Производительность

### Оптимизации:
- **React.memo** - Предотвращение лишних ререндеров
- **useCallback** - Мемоизация функций
- **Throttling** - Оптимизация обработчика прокрутки
- **Пассивные события** - Улучшение производительности скролла
- **CSS-анимации** - Аппаратное ускорение

### Рекомендации:
- Избегать частых обновлений состояния
- Использовать мемоизацию для сложных компонентов
- Оптимизировать CSS-анимации

## Тестирование

### Проверка функциональности:
1. **Базовая работа**: Кнопка видна на всех страницах
2. **Анимации**: Пульсация и переходы работают корректно
3. **Прокрутка**: Кнопка появляется/исчезает при скролле
4. **Чат**: Открытие/закрытие чата работает
5. **Мобильные устройства**: Адаптивность на разных экранах

### Тестовый файл:
- `test-floating-button.html` - Изолированный тест кнопки

## Будущие улучшения

### Возможные доработки:
- [ ] Настройка позиции кнопки (лево/право, верх/низ)
- [ ] Кастомизация цветов и размеров
- [ ] Дополнительные анимации
- [ ] Звуковые эффекты
- [ ] Интеграция с уведомлениями

## Поддержка

### Решение проблем:
1. **Кнопка не отображается**: Проверить интеграцию AIAssistantProvider
2. **Анимации не работают**: Проверить CSS-классы в index.css
3. **Чат не открывается/закрывается**: Проверить вызов toggleMinimized()
4. **Чат перекрывает сайт**: Проверить адаптивные стили в index.css
5. **Прокрутка не работает**: Проверить useScrollVisibility хук
6. **Чат не минимизируется**: Убедиться что EnhancedAIAssistantWrapper работает корректно
7. **Кнопка перекрывает контент**: Проверить z-index и позиционирование
8. **Мобильная адаптация**: Проверить media queries для разных размеров экранов

### Логирование:
Ошибки и предупреждения выводятся в консоль браузера для отладки.

---

## Заключение

Плавающая кнопка ИИ успешно интегрирована в приложение и предоставляет удобный доступ к ИИ-ассистенту с любых страниц. Компонент оптимизирован для производительности и адаптивен для разных устройств.